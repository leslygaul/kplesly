<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart</title>

    <!-- Add your stylesheets here -->
    <link rel="stylesheet" href="{{ url_for('static', filename='user/css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='user/css/style.css') }}">
    <!-- Add any additional stylesheets you need -->

    <!-- Add your JavaScript libraries here -->
    <script src="{{ url_for('static', filename='user/js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='user/js/popper.min.js') }}"></script>
    <script src="{{ url_for('static', filename='user/js/bootstrap.bundle.min.js') }}"></script>
    <!-- Add any additional scripts you need -->
</head>

<body class="main-layout product_page">
     <!-- header -->
     <header class="section fixed-top">
        <!-- header inner -->
       <div class="header_main">
        <div class="header_main">
           <div class="container">
              <div class="row">
                 <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col logo_section">
                    <div class="full">
                       <div class="center-desk">
                        <div class="logo"> <a href="{{ url_for('index') }}"><img src="{{ url_for('static', filename='user/images/logo.png') }}" alt="#"></a> </div>
                    </div>
                    </div>
                 </div>
                 <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9">
                    <div class="menu-area">
                       <div class="limit-box">
                          <nav class="main-menu">
                             <ul class="menu-area-main">
                                <li> <a href="{{ url_for('index') }}">Home</a> </li>
                                <li><a href="{{ url_for('shop') }}">Shop</a></li>
                                <li><a href="{{ url_for('cart') }}">Cart</a></li>
                                <li class="last"><a href="#"><img src="{{ url_for('static', filename='user/images/search_icon.png') }}" alt="icon"/></a></li>
                            </ul>
                          </nav>
                       </div>
                    </div>
                 </div>
              </div>
           </div>
        </div>
       </div>
        <!-- end header inner -->
     </header>
     <!-- end header -->

    <!-- Shopping Cart Content -->
    <div class="container mt-5 pt-5">
        <h2 class="mb-4 text-center">Your Shopping Cart</h2>
        <table class="table">
            <thead>
                <tr>
                    <th class="text-center">Item</th>
                    <th class="text-center">Qty</th>
                    <th class="text-center">Harga</th>
                </tr>
            </thead>
            <tbody id="cart-items"></tbody>
        </table>
        <div id="cart-summary" class="text-center mt-4">
            <p class="mb-2">Total Price: Rp.<span id="total-price">0.00</span></p>
            <a class="btn btn-primary float-right" href="{{ url_for('shop') }}" style="white-space: nowrap;">Continue</a>
        </div>
    </div>

    <!-- Add your footer content here -->
    <div class="footer layout_padding mt-auto">
        <div class="container">
            <p>Â© 2019 All Rights Reserved. Design by <a href="https://html.design/">Free Html Templates</a></p>
        </div>
    </div>

    <!-- Add your JavaScript files here -->
    <script src="{{ url_for('static', filename='user/js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='user/js/popper.min.js') }}"></script>
    <script src="{{ url_for('static', filename='user/js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='user/js/jquery-3.0.0.min.js') }}"></script>
    <script src="{{ url_for('static', filename='user/js/plugin.js') }}"></script>
    <!-- Add any additional scripts you need -->
    <!-- Add this inside your cart.html -->
    <style>
        #cart-items td,
        #cart-items th {
            text-align: center;
        }

        .btn-primary {
            display: inline-block;
            background-color: #007bff;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-size: 16px;
        }

        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    </style>
    <script>
        // Your existing JavaScript code remains unchanged
        function addToCart(id, nama, harga) {
            $.ajax({
                type: "POST",
                url: "/add-to-cart",
                contentType: "application/json",
                data: JSON.stringify({ id: id, nama: nama, harga: harga }),
                success: function(response) {
                    alert("Product added to the cart!");
                    getCartItems();
                },
                error: function(error) {
                    alert("Failed to add product to the cart.");
                }
            });
        }

        function getCartItems() {
            $.ajax({
                type: "GET",
                url: "/get-cart",
                success: function(cart) {
                    displayCartItems(cart);
                },
                error: function(error) {
                    console.error("Error getting cart items:", error);
                }
            });
        }

        function displayCartItems(cart) {
            var cartItemsContainer = $("#cart-items");
            var totalPriceElement = $("#total-price");
            cartItemsContainer.empty();

            if (cart.length === 0) {
                cartItemsContainer.append("<tr><td colspan='3'>Your cart is empty.</td></tr>");
            } else {
                var totalPrice = 0;

                cart.forEach(function(item) {
                    var row = "<tr>" +
                        "<td>" + item.nama + "</td>" +
                        "<td>" + item.quantity + "</td>" +
                        "<td>$" + (item.harga * item.quantity).toFixed(2) + "</td>" +
                        "</tr>";
                    cartItemsContainer.append(row);
                    totalPrice += item.harga * item.quantity;
                });

                // Display total price
                totalPriceElement.text(totalPrice.toFixed(2));
            }
        }

        // Load cart items on page load
        $(document).ready(function() {
            getCartItems();
        });
    </script>
</body>

</html>
